package com.sulfurengine;

import javax.swing.JFrame;

public class Display {
	private int width, height;
	private String title;
	private static Display instance = null;
	
	private JFrame frame;
	private Renderer renderer;
	private Scene currentScene = null;
	
	private Display() {};
	
	public static Display get() {
		if(instance == null) {
			instance = new Display();
		} 
		return instance;
	}
	
	public void setScene(Scene scene) {
		this.currentScene = scene;
		this.currentScene.start();
	}
	
	public void init(int w, int h, String t) {
		this.width = w;
		this.height = h;
		this.title = t;
		
		frame = new JFrame(title);
		frame.setSize(width, height);
		
		frame.setResizable(true);
		frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		
		Input.initialize(frame);
		
		renderer = new Renderer();
		frame.add(renderer);
		
		frame.setVisible(true);
	}
	
	public void update() {
		Debug.Log("Display Update");
        float beginTime = (float)System.currentTimeMillis();
        float endTime;
        float dt = -1.0f;
        
        if(currentScene == null) {
        	Debug.LogError("Scene is null");
        	return;
        }
        Debug.Logf("DeltaTime: %f", dt);
        if(dt > 0) {
        	Debug.Log("Display calling scene update");
        	currentScene.update(dt);
        	
        	renderer.repaint();
        }
        
		endTime = (float)System.currentTimeMillis();
		dt = endTime - beginTime;
		beginTime = endTime;
	}

	public int width() {
		return width;
	}

	public int height() {
		return height;
	}

	public Scene getScene() {
		return this.currentScene;
	}
}
