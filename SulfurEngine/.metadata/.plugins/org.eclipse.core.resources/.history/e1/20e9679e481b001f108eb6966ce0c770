package com.sulfurengine.io;

import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

import com.sulfurengine.renderer.DirtyFlag;

public class SceneManager {
    
    private static List<Scene> scenes = Collections.synchronizedList(new ArrayList<>());
    private static List<Scene> initialScenes = new ArrayList<>();
    
    public static void addScene(Scene scene) {
        // Add the original scene
		scenes.add(scene);
		// Store a clone of the initial state
		initialScenes.add((Scene) scene.clone());
    }
    
    public static void setScene(int index) {
        synchronized (scenes) {
            if (index < 0 || index >= scenes.size()) {
                throw new IndexOutOfBoundsException("Invalid scene index: " + index);
            }
            
            try {
                // Replace the current scene with a clone of the initial state
                Scene newScene = (Scene) initialScenes.get(index).clone();
                Display.currentScene = newScene;
                newScene.start();
                DirtyFlag.dirty = true;
            } catch (CloneNotSupportedException e) {
                e.printStackTrace();
            }
        }
    }
}
